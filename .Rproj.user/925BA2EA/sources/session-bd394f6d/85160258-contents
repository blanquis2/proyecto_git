
                          #Alineamiento de globinas#


#cargar los paquetes
library(BSgenome)
library(BiocIO)
library(GenomicRanges)
library(rtracklayer)
library(msa)

#agregar el archivo al doc

globinas<-readDNAStringSet("datos/DivergentGlobins.fasta")
globinas

#alineamiento

clustal_globinas<-msa(globinas,method = "ClustalW")
clustal_globinas

muscle_globinas<-msa(globinas, method = "Muscle")
muscle_globinas

#árboles

#cargar el paquete

library(ape)

install.packages("seqinr")
library(seqinr)

#Cambiar el tipo de objeto#

globinas1<-msaConvert(clustal_globinas,type="seqinr::alignment")
globinas1


globinas2<-msaConvert(muscle_globinas,type="seqinr::alignment")
globinas2

#hacer las matrices de distancias
mat1<-dist.alignment(globinas1)
mat2<-dist.alignment(globinas2)
  
#árbol#
pdf("resultado/arboles.pdf")

arbol1<-nj(mat1)#con clustalw
arbol1
plot(arbol1)
arbol2<-nj(mat2)#con muscle
arbol2
plot(arbol2)
dev.off()

#Ejercicios con ggtree#
install.packages("ggtree")
library(ggtree)

class(arbol1)#verificar que la clase sea phylo
class(arbol2)


arbolito1<- ggtree(arbol1, layout = 'circular', branch.length='none')+
  geom_tiplab(colour="bisque3")
arbolito1

###ggtree

#Árbol random

plot(rtree(10))->arbolito

#Se puede personalizar agregando capas

ggtree(arbolito)+
  geom_tiplab(size=5, colour="bisque2")

#resaltar clados
geom_cladelab()

#señalar con color ciertos clados
geom_hilight()

#guadar el gráfico
ggsave("resultado/arbolito.png")#elegir el formato favorito

#asignar nombres
class(arbolito)

#arbolito1 
ggsave("resultado/arbolclustalw.png")
arbolito1<- ggtree(arbol1, layout = 'circular', branch.length='none')+
  geom_tiplab(colour="bisque3")
arbolito1
dev.off()
##arbolito2
ggsave("resultado/arbolmuscle.png")
arbolito2<- ggtree(arbol2, layout = 'circular', branch.length='none')+
  geom_tiplab(colour="bisque2")
arbolito2
